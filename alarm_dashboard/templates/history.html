<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Einsatzhistorie</title>
    <link rel="stylesheet" href="/static/css/history.css">
</head>
<body>
    <div class="history-app">
        <div class="history-topline" aria-hidden="true"></div>
        <header class="history-header">
            <div class="history-brand">
                <h1>
                    Feuerwehr
                    <span>{{ department_name }}</span>
                </h1>
            </div>
            <img src="{{ crest_url }}" alt="Gemeindewappen" class="history-crest">
        </header>
        <main>
            {% if entries %}
            <section class="history-table-section" aria-labelledby="history-title">
                <h2 id="history-title" class="history-section-title">Alarm-Historie</h2>
                <div class="history-table-wrap">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th scope="col">Datum</th>
                                <th scope="col">Uhrzeit</th>
                                <th scope="col">Stichwort</th>
                                <th scope="col">Ort</th>
                                <th scope="col">Beschreibung</th>
                                <th scope="col">Alarmierte Fahrzeuge</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for entry in entries %}
                            <tr>
                                <td data-label="Datum">{{ entry.display_date }}</td>
                                <td data-label="Uhrzeit">{{ entry.display_time }}</td>
                                <td data-label="Stichwort">{{ entry.keyword or "-" }}</td>
                                <td data-label="Ort">{{ entry.location or "-" }}</td>
                                <td data-label="Beschreibung">
                                    {% if entry.description %}
                                    <div class="history-description">{{ entry.description }}</div>
                                    {% else %}
                                    <div class="history-description">-</div>
                                    {% endif %}
                                    {% if entry.remark %}
                                    <div class="history-remark">{{ entry.remark }}</div>
                                    {% endif %}
                                </td>
                                <td data-label="Alarmierte Fahrzeuge">
                                    {% set vehicles = entry.aao_groups %}
                                    {% if vehicles %}
                                        {% if vehicles is string %}
                                            {{ vehicles }}
                                        {% else %}
                                            {{ vehicles | join(', ') }}
                                        {% endif %}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </section>
            {% else %}
            <p class="history-empty">Keine Einsätze vorhanden.</p>
            {% endif %}
        </main>
        <nav class="bottom-nav" aria-label="Hauptnavigation">
            <a href="/" class="bottom-nav__item" aria-label="Zurück zum Dashboard">
                <span class="bottom-nav__icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" role="presentation">
                        <path d="M13 5 6 12l7 7 1.5-1.5L9 12l5.5-5.5z" />
                    </svg>
                </span>
                <span class="bottom-nav__label">Zurück</span>
            </a>
            <a href="/history" class="bottom-nav__item bottom-nav__item--active">
                <span class="bottom-nav__icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" role="presentation">
                        <path d="M19 4h-1V2h-2v2H8V2H6v2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 16H5V9h14zm-9-7h2v2h-2zm4 0h2v2h-2zm-8 0h2v2H6z" />
                    </svg>
                </span>
                <span class="bottom-nav__label">Historie</span>
            </a>
            <a href="/settings" class="bottom-nav__item" aria-label="Einstellungen">
                <span class="bottom-nav__icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" role="presentation">
                        <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
                    </svg>
                </span>
                <span class="bottom-nav__label">Einstellungen</span>
            </a>
            <div class="bottom-nav__meta" role="contentinfo">
                <span class="bottom-nav__credit">
                    © <a
                        href="mailto:t.braun@feuerwehr-willingshausen.de"
                        class="bottom-nav__credit-link"
                    >Timo Braun</a>
                </span>
                {% if app_version %}
                    {% if app_version_url %}
                        <a
                            href="{{ app_version_url }}"
                            class="bottom-nav__version"
                            target="_blank"
                            rel="noopener noreferrer"
                        >Version {{ app_version }}</a>
                    {% else %}
                        <span class="bottom-nav__version">Version {{ app_version }}</span>
                    {% endif %}
                {% endif %}
            </div>
        </nav>
    </div>
</body>
</html>
